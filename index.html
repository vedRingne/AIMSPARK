<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIMSPARK 2025 - Registration</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/supabase-js/2.39.3/umd/supabase.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Navigation */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s;
            cursor: pointer;
        }

        .nav-links a:hover,
        .nav-links a.active {
            color: #667eea;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logout-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
        }

        /* Auth Forms */
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 2rem;
        }

        .auth-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 3rem;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .auth-title {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: #333;
        }

        .auth-subtitle {
            color: #666;
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #333;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .auth-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-bottom: 1rem;
            transition: transform 0.2s;
        }

        .auth-btn:hover {
            transform: translateY(-2px);
        }

        .auth-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .auth-switch {
            color: #667eea;
            cursor: pointer;
            text-decoration: underline;
        }

        /* Main Content */
        .main-content {
            padding: 2rem 0;
            background: rgba(255, 255, 255, 0.9);
            min-height: calc(100vh - 80px);
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .hero {
            text-align: center;
            padding: 4rem 0;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #333;
        }

        .hero p {
            font-size: 1.2rem;
            color: #666;
            max-width: 600px;
            margin: 0 auto 2rem;
        }

        .cta-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            padding: 1rem 2rem;
            border-radius: 10px;
            font-weight: 600;
            display: inline-block;
            transition: transform 0.2s;
        }

        .cta-btn:hover {
            transform: translateY(-2px);
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            padding: 2rem 0;
        }

        .feature-card {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .problem-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .problem-card {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #667eea;
        }

        .team-form {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            margin: 2rem auto;
        }

        .team-form h2 {
            margin-bottom: 1.5rem;
            color: #333;
        }

        .team-form .form-group {
            margin-bottom: 1.5rem;
        }

        .team-form input,
        .team-form textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            font-size: 1rem;
        }

        .team-form textarea {
            height: 100px;
            resize: vertical;
        }

        .member-input {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .member-input input {
            flex: 1;
        }

        .add-member-btn,
        .remove-member-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
        }

        .remove-member-btn {
            background: #ff4757;
        }

        .team-dashboard {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            margin: 2rem auto;
        }

        .team-info {
            border: 2px solid #667eea;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            background: #f8f9ff;
        }

        .member-list {
            list-style: none;
            padding: 0;
        }

        .member-list li {
            background: #f5f5f5;
            padding: 0.5rem 1rem;
            margin-bottom: 0.5rem;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .instructions {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            margin: 2rem auto;
        }

        .instructions h2 {
            color: #667eea;
            margin-bottom: 1rem;
        }

        .instructions ol {
            padding-left: 1.5rem;
        }

        .instructions li {
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .hidden {
            display: none !important;
        }

        .alert {
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1rem;
        }

        .alert.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .features {
                grid-template-columns: 1fr;
            }

            .problem-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Authentication Section -->
    <div id="authSection" class="auth-container">
        <div class="auth-card">
            <div id="loginForm">
                <h2 class="auth-title">Welcome to AIMSPARK</h2>
                <p class="auth-subtitle">Sign in to your hackathon account</p>
                <div id="authAlert"></div>
                <form>
                    <div class="form-group">
                        <label for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <button type="submit" class="auth-btn" id="loginBtn">Sign In</button>
                </form>
                <p>Don't have an account? <span class="auth-switch" id="showSignup">Sign up here</span></p>
            </div>

            <div id="signupForm" class="hidden">
                <h2 class="auth-title">Join AIMSPARK 2025</h2>
                <p class="auth-subtitle">Create your account to get started</p>
                <div id="signupAlert"></div>
                <form>
                    <div class="form-group">
                        <label for="signupName">Full Name</label>
                        <input type="text" id="signupName" required>
                    </div>
                    <div class="form-group">
                        <label for="signupEmail">Email</label>
                        <input type="email" id="signupEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="signupPassword">Password</label>
                        <input type="password" id="signupPassword" required>
                    </div>
                    <button type="submit" class="auth-btn" id="signupBtn">Create Account</button>
                </form>
                <p>Already have an account? <span class="auth-switch" id="showLogin">Sign in here</span></p>
            </div>
        </div>
    </div>

    <!-- Main Website -->
    <div id="mainWebsite" class="hidden">
        <!-- Navigation -->
        <nav class="navbar">
            <div class="container">
                <div class="nav-content">
                    <div class="logo">AIMSPARK 2025</div>
                    <ul class="nav-links">
                        <li><a href="#" class="nav-link active" data-page="home">Home</a></li>
                        <li><a href="#" class="nav-link" data-page="problems">Problems</a></li>
                        <li><a href="#" class="nav-link" data-page="createTeam">Create Team</a></li>
                        <li><a href="#" class="nav-link" data-page="dashboard">Dashboard</a></li>
                        <li><a href="#" class="nav-link" data-page="instructions">Instructions</a></li>
                    </ul>
                    <div class="user-info">
                        <span id="userEmail"></span>
                        <button class="logout-btn" id="logoutBtn">Logout</button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <!-- Home Page -->
                <div id="home" class="page active">
                    <div class="hero">
                        <h1>AIMSPARK 2025</h1>
                        <p>Join the biggest hackathon of the year! Build innovative solutions, connect with amazing developers, and compete for incredible prizes.</p>
                        <a href="#" class="cta-btn nav-link" data-page="problems">Explore Problems</a>
                    </div>
                    <div class="features">
                        <!-- <div class="feature-card">
                            <div class="feature-icon">üèÜ</div>
                            <h3>$50,000 in Prizes</h3>
                            <p>Compete for cash prizes, internships, and exciting opportunities with leading tech companies.</p>
                        </div> -->
                        <div class="feature-card">
                            <div class="feature-icon">ü§ù</div>
                            <h3>Network & Learn</h3>
                            <p>Connect with fellow developers, mentors, and industry professionals from around the world.</p>
                        </div>
                        <!-- <div class="feature-card">
                            <div class="feature-icon">‚ö°</div>
                            <h3>48 Hour Challenge</h3>
                            <p>Build amazing projects in just 48 hours with your team and showcase your skills.</p>
                        </div> -->
                    </div>
                </div>

                <!-- Problem Statements Page -->
                <div id="problems" class="page">
                    <h1>Problem Statements</h1>
                    <p>Choose from these exciting challenges and build solutions that matter:</p>
                    <div class="problem-grid">
                        <div class="problem-card">
                            <h3>üå± Sustainable Tech Solutions</h3>
                            <p><strong>Challenge:</strong> Create technology solutions that address environmental challenges and promote sustainability.</p>
                            <p><strong>Focus Areas:</strong> Clean energy, waste reduction, carbon footprint tracking, sustainable agriculture</p>
                            <p><strong>Prize:</strong> $15,000</p>
                        </div>
                        <div class="problem-card">
                            <h3>üè• Healthcare Innovation</h3>
                            <p><strong>Challenge:</strong> Develop digital health solutions that improve patient care and accessibility.</p>
                            <p><strong>Focus Areas:</strong> Telemedicine, mental health, medical data analysis, accessibility tools</p>
                            <p><strong>Prize:</strong> $12,000</p>
                        </div>
                        <div class="problem-card">
                            <h3>üéì Education Technology</h3>
                            <p><strong>Challenge:</strong> Build platforms and tools that enhance learning experiences and educational outcomes.</p>
                            <p><strong>Focus Areas:</strong> Online learning, skill assessment, educational games, accessibility</p>
                            <p><strong>Prize:</strong> $10,000</p>
                        </div>
                        <div class="problem-card">
                            <h3>üèôÔ∏è Innovation</h3>
                            <!-- <p><strong>Challenge:</strong> Design solutions for urban challenges using IoT, AI, and data analytics.</p>
                            <p><strong>Focus Areas:</strong> Traffic management, public safety, energy efficiency, citizen services</p>
                            <p><strong>Prize:</strong> $13,000</p> -->
                            <p>Bring your own project</p>
                        </div>
                    </div>
                </div>

                <!-- Create Team Page -->
                <div id="createTeam" class="page">
                    <h1>Create Your Team</h1>
                    <div class="team-form">
                        <h2>Team Registration</h2>
                        <div id="teamAlert"></div>
                        <form id="teamForm">
                            <div class="form-group">
                                <label for="teamName">Team Name</label>
                                <input type="text" id="teamName" required>
                            </div>
                            <div class="form-group">
                                <label for="problemStatement">Selected Problem Statement</label>
                                <select id="problemStatement" required>
                                    <option value="">Choose a problem statement</option>
                                    <option value="sustainable">Sustainable Tech Solutions</option>
                                    <option value="healthcare">Healthcare Innovation</option>
                                    <option value="education">Education Technology</option>
                                    <option value="smartcities">Innovation</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="teamDescription">Team Description</label>
                                <textarea id="teamDescription" placeholder="Describe your team's skills and goals..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>Team Members (including you)</label>
                                <div id="membersList">
                                    <div class="member-input">
                                        <input type="email" placeholder="Member email" required>
                                        <button type="button" class="add-member-btn" onclick="addMember()">+</button>
                                    </div>
                                </div>
                            </div>
                            <button type="submit" class="auth-btn">Create Team</button>
                        </form>
                    </div>
                </div>

                <!-- Team Dashboard -->
                <div id="dashboard" class="page">
                    <h1>Team Dashboard</h1>
                    <div class="team-dashboard">
                        <div id="teamStatus">
                            <div id="noTeam">
                                <h2>No Team Found</h2>
                                <p>You haven't created or joined a team yet. <a href="#" class="nav-link" data-page="createTeam">Create a team</a> to get started!</p>
                            </div>
                            <div id="hasTeam" class="hidden">
                                <div class="team-info">
                                    <h2 id="dashboardTeamName">Team Name</h2>
                                    <p><strong>Problem Statement:</strong> <span id="dashboardProblem"></span></p>
                                    <p><strong>Description:</strong> <span id="dashboardDescription"></span></p>
                                    <p><strong>Team Leader:</strong> <span id="dashboardLeader"></span></p>
                                </div>
                                <h3>Team Members</h3>
                                <ul id="dashboardMembers" class="member-list"></ul>
                                <div style="margin-top: 2rem;">
                                    <h3>Submission</h3>
                                    <p>Project submission will be available 24 hours before the deadline.</p>
                                    <button class="auth-btn" disabled>Submit Project (Coming Soon)</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Instructions Page -->
                <div id="instructions" class="page">
                    <h1>Hackathon Instructions</h1>
                    <div class="instructions">
                        <h2>üìã Registration & Team Formation</h2>
                        <ol>
                            <li>Create your account and complete your profile</li>
                            <li>Form a team of 2-4 members or join an existing team</li>
                            <li>Select one problem statement from the available options</li>
                            <li>Submit your team registration before the deadline</li>
                        </ol>

                        <!-- <h2>‚ö° Hackathon Timeline</h2>
                        <ol>
                            <li><strong>Registration:</strong> March 1-15, 2025</li>
                            <li><strong>Team Formation:</strong> March 16-20, 2025</li>
                            <li><strong>Hackathon Event:</strong> March 22-24, 2025 (48 hours)</li>
                            <li><strong>Submission Deadline:</strong> March 24, 2025, 6:00 PM</li>
                            <li><strong>Judging & Results:</strong> March 25-26, 2025</li>
                        </ol> -->

                        <h2>üîß Technical Requirements</h2>
                        <ol>
                            <li>Projects must be built during the hackathon period</li>
                            <li>Use any programming language or technology stack</li>
                            <li>Code must be hosted on GitHub with proper documentation</li>
                            <li>Include a demo video (max 3 minutes) showcasing your solution</li>
                            <li>Prepare a presentation for the judging panel</li>
                        </ol>

                        <h2>üìù Submission Guidelines</h2>
                        <ol>
                            <li>Submit your project through the team dashboard</li>
                            <li>Include: GitHub repository link, demo video, and presentation slides</li>
                            <li>Write a clear README with installation and usage instructions</li>
                            <li>Ensure your project addresses the chosen problem statement</li>
                        </ol>

                        <!-- <h2>üèÜ Judging Criteria</h2>
                        <ol>
                            <li><strong>Innovation (25%):</strong> Creativity and uniqueness of the solution</li>
                            <li><strong>Technical Implementation (25%):</strong> Code quality and technical complexity</li>
                            <li><strong>Impact (25%):</strong> Potential real-world impact and problem-solving effectiveness</li>
                            <li><strong>Presentation (25%):</strong> Quality of demo, documentation, and presentation</li>
                        </ol> -->

                        <h2>üìû Support & Resources</h2>
                        <ol>
                            <li>Discord server for real-time communication and support</li>
                            <li>Mentorship sessions available throughout the event</li>
                            <li>Technical workshops on popular frameworks and tools</li>
                            <li>24/7 support team for technical and logistical issues</li>
                        </ol>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Initialize Supabase client
        const supabaseUrl = 'https://pfgnanvvzsdldjpdcbjy.supabase.co'; // Replace with your Supabase URL
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBmZ25hbnZ2enNkbGRqcGRjYmp5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcxODI0MjMsImV4cCI6MjA3Mjc1ODQyM30.wEADUYqOpiCIiLAnCFMJ8btUy21UxH2aJSdmZ_rap6U'; // Replace with your Supabase anon key
        
        // For demo purposes, we'll simulate auth without actual Supabase
        let currentUser = null;
        let teams = {};

        // DOM Elements
        const authSection = document.getElementById('authSection');
        const mainWebsite = document.getElementById('mainWebsite');
        const loginForm = document.getElementById('loginForm');
        const signupForm = document.getElementById('signupForm');
        const showSignupBtn = document.getElementById('showSignup');
        const showLoginBtn = document.getElementById('showLogin');
        const loginBtn = document.getElementById('loginBtn');
        const signupBtn = document.getElementById('signupBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const userEmail = document.getElementById('userEmail');

        // Navigation
        const navLinks = document.querySelectorAll('.nav-link');
        const pages = document.querySelectorAll('.page');

        // Team form
        const teamForm = document.getElementById('teamForm');

        // Initialize app
        function init() {
            // Check if user is already logged in (simulate with localStorage)
            const storedUser = localStorage.getItem('currentUser');
            if (storedUser) {
                currentUser = JSON.parse(storedUser);
                showMainWebsite();
            }

            // Event listeners
            showSignupBtn.addEventListener('click', () => {
                loginForm.classList.add('hidden');
                signupForm.classList.remove('hidden');
            });

            showLoginBtn.addEventListener('click', () => {
                signupForm.classList.add('hidden');
                loginForm.classList.remove('hidden');
            });

            loginForm.addEventListener('submit', handleLogin);
            signupForm.addEventListener('submit', handleSignup);
            logoutBtn.addEventListener('click', handleLogout);
            teamForm.addEventListener('submit', handleTeamCreation);

            // Navigation
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetPage = link.getAttribute('data-page');
                    if (targetPage) {
                        showPage(targetPage);
                    }
                });
            });
        }

        // Authentication functions
        async function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            // Simulate authentication
            if (email && password) {
                currentUser = { email, id: generateId() };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                showMainWebsite();
                showAlert('authAlert', 'Login successful!', 'success');
            } else {
                showAlert('authAlert', 'Please fill in all fields', 'error');
            }
        }

        async function handleSignup(e) {
            e.preventDefault();
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;

            // Simulate authentication
            if (name && email && password) {
                currentUser = { email, name, id: generateId() };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                showMainWebsite();
                showAlert('signupAlert', 'Account created successfully!', 'success');
            } else {
                showAlert('signupAlert', 'Please fill in all fields', 'error');
            }
        }

        function handleLogout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            localStorage.removeItem('userTeam');
            authSection.classList.remove('hidden');
            mainWebsite.classList.add('hidden');
        }

        function showMainWebsite() {
            authSection.classList.add('hidden');
            mainWebsite.classList.remove('hidden');
            
            // Display user email from appropriate source
            const displayEmail = currentUser.email || currentUser.user_metadata?.email || 'User';
            userEmail.textContent = displayEmail;
            loadTeamDashboard();
        }

        // Navigation
        function showPage(pageId) {
            pages.forEach(page => page.classList.remove('active'));
            navLinks.forEach(link => link.classList.remove('active'));
            
            document.getElementById(pageId).classList.add('active');
            document.querySelector(`[data-page="${pageId}"]`).classList.add('active');
        }

        // Team management with Supabase integration
        function addMember() {
            const membersList = document.getElementById('membersList');
            const memberDiv = document.createElement('div');
            memberDiv.className = 'member-input';
            memberDiv.innerHTML = `
                <input type="email" placeholder="Member email" required>
                <button type="button" class="remove-member-btn" onclick="removeMember(this)">-</button>
            `;
            membersList.appendChild(memberDiv);
        }

        function removeMember(btn) {
            const membersList = document.getElementById('membersList');
            if (membersList.children.length > 1) {
                btn.parentElement.remove();
            }
        }

        async function handleTeamCreation(e) {
            e.preventDefault();
            
            const teamName = document.getElementById('teamName').value;
            const problemStatement = document.getElementById('problemStatement').value;
            const teamDescription = document.getElementById('teamDescription').value;
            
            const memberInputs = document.querySelectorAll('#membersList input[type="email"]');
            const members = Array.from(memberInputs).map(input => input.value).filter(email => email);
            
            if (members.length > 4) {
                showAlert('teamAlert', 'Maximum 4 members allowed per team', 'error');
                return;
            }

            const submitBtn = e.target.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Creating Team...';

            try {
                const team = {
                    name: teamName,
                    problem_statement: problemStatement,
                    description: teamDescription,
                    leader_id: currentUser.id,
                    leader_email: currentUser.email,
                    members: members,
                    created_at: new Date().toISOString()
                };

                if (typeof supabase !== 'undefined' && supabaseUrl !== 'YOUR_SUPABASE_URL') {
                    // Real Supabase database insertion
                    const { data, error } = await supabase
                        .from('teams')
                        .insert([team])
                        .select()
                        .single();

                    if (error) {
                        throw error;
                    }

                    // Store team ID for quick access
                    localStorage.setItem('userTeamId', data.id);
                    showAlert('teamAlert', 'Team created successfully!', 'success');
                } else {
                    // Fallback to localStorage
                    team.id = generateId();
                    localStorage.setItem('userTeam', JSON.stringify(team));
                    showAlert('teamAlert', 'Team created successfully! (Demo mode)', 'success');
                }

                // Reset form
                teamForm.reset();
                document.getElementById('membersList').innerHTML = `
                    <div class="member-input">
                        <input type="email" placeholder="Member email" required>
                        <button type="button" class="add-member-btn" onclick="addMember()">+</button>
                    </div>
                `;

                // Update dashboard
                loadTeamDashboard();
            } catch (error) {
                showAlert('teamAlert', `Error creating team: ${error.message}`, 'error');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Create Team';
            }
        }

        async function loadTeamDashboard() {
            const noTeamDiv = document.getElementById('noTeam');
            const hasTeamDiv = document.getElementById('hasTeam');

            try {
                let team = null;

                if (typeof supabase !== 'undefined' && supabaseUrl !== 'YOUR_SUPABASE_URL') {
                    // Real Supabase data loading
                    const { data, error } = await supabase
                        .from('teams')
                        .select('*')
                        .eq('leader_id', currentUser.id)
                        .single();

                    if (error && error.code !== 'PGRST116') { // PGRST116 is "not found"
                        throw error;
                    }

                    team = data;
                } else {
                    // Fallback to localStorage
                    const userTeam = localStorage.getItem('userTeam');
                    if (userTeam) {
                        team = JSON.parse(userTeam);
                    }
                }

                if (team) {
                    noTeamDiv.classList.add('hidden');
                    hasTeamDiv.classList.remove('hidden');

                    // Populate team info
                    document.getElementById('dashboardTeamName').textContent = team.name;
                    document.getElementById('dashboardProblem').textContent = getProblemTitle(team.problem_statement || team.problem);
                    document.getElementById('dashboardDescription').textContent = team.description;
                    document.getElementById('dashboardLeader').textContent = team.leader_email || team.leader;

                    // Populate members list
                    const membersList = document.getElementById('dashboardMembers');
                    membersList.innerHTML = '';
                    
                    if (team.members && team.members.length > 0) {
                        team.members.forEach((member, index) => {
                            const li = document.createElement('li');
                            const isLeader = member === (team.leader_email || team.leader);
                            li.innerHTML = `
                                <span>${member} ${isLeader ? '(Leader)' : ''}</span>
                                <span>${isLeader ? 'üëë' : 'üë§'}</span>
                            `;
                            membersList.appendChild(li);
                        });
                    } else {
                        const li = document.createElement('li');
                        li.innerHTML = `
                            <span>${team.leader_email || team.leader} (Leader)</span>
                            <span>üëë</span>
                        `;
                        membersList.appendChild(li);
                    }
                } else {
                    noTeamDiv.classList.remove('hidden');
                    hasTeamDiv.classList.add('hidden');
                }
            } catch (error) {
                console.error('Error loading team dashboard:', error);
                showAlert('teamAlert', `Error loading team data: ${error.message}`, 'error');
            }
        }

        function getProblemTitle(problemKey) {
            const problems = {
                'sustainable': 'Sustainable Tech Solutions',
                'healthcare': 'Healthcare Innovation',
                'education': 'Education Technology',
                'smartcities': 'Smart Cities'
            };
            return problems[problemKey] || problemKey;
        }

        // Utility functions
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        function showAlert(containerId, message, type) {
            const container = document.getElementById(containerId);
            container.innerHTML = `<div class="alert ${type}">${message}</div>`;
            setTimeout(() => {
                container.innerHTML = '';
            }, 5000);
        }

        // Initialize the app when the page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>